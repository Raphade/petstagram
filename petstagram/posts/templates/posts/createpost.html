{% extends "posts/base.html" %}

{% block content %}
    <div class="content-section">
        <h2>Create a New Post</h2>
        <form method="POST">
            {% csrf_token %}
            {% if user.is_authenticated %}
                <input type="hidden" name="user_id" value="{{ user.id }}">
                <div class="form-group">
                    <label for="poster">Poster:</label>
                    <input type="text" class="form-control" id="poster" name="poster" required>
                </div>
                <div class="form-group">
                    <label for="date">Date:</label>
                    <input type="text" class="form-control" id="date" name="date" value="{{ now|date:'Y-m-d H:i:s' }}" readonly>
                </div>
                <div class="form-group">
                    <label for="description">Description:</label>
                    <textarea class="form-control" id="description" name="description" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Create Post</button>
            {% else %}
                <p>You need to be logged in to create a new post.</p>
                <a href="{% url 'login' %}">Login</a> | <a href="{% url 'register' %}">Register</a>
            {% endif %}
        </form>
    </div>
    <script>
        function getCurrentDate() {
            var now = new Date();
            var year = now.getFullYear();
            var month = ('0' + (now.getMonth() + 1)).slice(-2);
            var day = ('0' + now.getDate()).slice(-2);
            var hours = ('0' + now.getHours()).slice(-2);
            var minutes = ('0' + now.getMinutes()).slice(-2);
            var seconds = ('0' + now.getSeconds()).slice(-2);

            return year + '-' + month + '-' + day + ' ' + hours + ':' + minutes + ':' + seconds;
        }

        document.getElementById('date').value = getCurrentDate();
    </script>

    {% endblock content %}
